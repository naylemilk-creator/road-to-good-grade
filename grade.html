<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</title>
  <style>
    body { font-family: 'Prompt', sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #aaa; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    input[type="number"], select, input[type="text"] { width: 80px; }
    .result { margin-top: 30px; font-weight: bold; font-size: 1.2em; }
    button { padding: 10px 20px; margin-top: 10px; font-size: 1em; }
  </style>
</head>
<body>

  <h2> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡∏£‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h2>
  <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ ‡πÅ‡∏•‡∏∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì"</p>

  <form id="gradeForm">
    <table>
      <thead>
        <tr>
          <th>‡∏ß‡∏¥‡∏ä‡∏≤</th>
          <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï</th>
          <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ (‡πÄ‡∏ï‡πá‡∏° 50)</th>
          <th>‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</th>
          <th>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th>
        </tr>
      </thead>
      <tbody id="subjectsTable"></tbody>
    </table>

    <button type="button" onclick="calculate()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
  </form>

  <hr>

  <h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>
  <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï</p>
  <input type="text" id="newSubjectName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤" />
  <input type="number" id="newSubjectCredit" placeholder="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï" min="0.5" step="0.5" />
  <button onclick="addSubject()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤</button>

  <div class="result" id="gpaResult"></div>

  <script>
    const subjects = [
      { name: "‡πÑ‡∏ó‡∏¢", credit: 1.0 },
      { name: "‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", credit: 1.0 },
      { name: "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì", credit: 0.5 },
      { name: "‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤", credit: 1.0 },
      { name: "‡∏™‡∏∏‡∏Ç‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏®‡∏∂‡∏Å‡∏©‡∏≤", credit: 0.5 },
      { name: "‡∏®‡∏¥‡∏•‡∏õ‡∏∞", credit: 0.5 },
      { name: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©", credit: 1.0 },
      { name: "‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", credit: 1.5 },
      { name: "‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå", credit: 1.5 },
      { name: "‡πÄ‡∏Ñ‡∏°‡∏µ", credit: 1.5 },
      { name: "‡∏ä‡∏µ‡∏ß‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", credit: 1.5 },
      { name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°", credit: 1.0 },
      { name: "‡πÇ‡∏•‡∏Å‡∏î‡∏≤‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", credit: 1.0 },
      { name: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞", credit: 1.5 }
    ];

    const gradeThresholds = [
      { grade: 4.0, totalRequired: 80 },
      { grade: 3.5, totalRequired: 75 },
      { grade: 3.0, totalRequired: 70 },
      { grade: 2.5, totalRequired: 65 },
      { grade: 2.0, totalRequired: 60 },
      { grade: 1.0, totalRequired: 50 },
      { grade: 0.0, totalRequired: 0 }
    ];

    const tableBody = document.getElementById("subjectsTable");

    function renderTable() {
      tableBody.innerHTML = "";
      subjects.forEach((subject, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${subject.name}</td>
          <td>${subject.credit}</td>
          <td><input type="number" id="score-${index}" min="0" max="50" required></td>
          <td>
            <select id="target-${index}">
              <option value="4.0">4.0</option>
              <option value="3.5">3.5</option>
              <option value="3.0">3.0</option>
              <option value="2.5">2.5</option>
              <option value="2.0">2.0</option>
              <option value="1.0">1.0</option>
            </select>
          </td>
          <td id="result-${index}">-</td>
        `;
        tableBody.appendChild(row);
      });
    }

    function calculate() {
      let totalCredits = 0;
      let totalWeightedGrade = 0;

      subjects.forEach((subject, index) => {
        const input = document.getElementById(`score-${index}`);
        const select = document.getElementById(`target-${index}`);
        const resultCell = document.getElementById(`result-${index}`);

        const midterm = parseFloat(input.value);
        const targetGrade = parseFloat(select.value);

        const threshold = gradeThresholds.find(g => g.grade === targetGrade);
        if (!threshold || isNaN(midterm) || midterm < 0 || midterm > 50) {
          resultCell.innerHTML = "‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
          return;
        }

        const requiredFinal = threshold.totalRequired - midterm;

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        if (requiredFinal > 50) {
          // ‡∏´‡∏≤‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á
          let bestGrade = 0.0;
          let bestRequired = null;
          for (const g of gradeThresholds) {
            const needed = g.totalRequired - midterm;
            if (needed <= 50) {
              bestGrade = g.grade;
              bestRequired = needed > 0 ? needed : 0;
              break;
            }
          }
          resultCell.innerHTML = `‚ùó ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÄ‡∏Å‡∏£‡∏î ${bestGrade.toFixed(1)} (‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î ${bestRequired.toFixed(1)} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)`;
          totalCredits += subject.credit;
          totalWeightedGrade += subject.credit * bestGrade;
        } else {
          resultCell.innerHTML = `‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${requiredFinal.toFixed(1)} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`;
          totalCredits += subject.credit;
          totalWeightedGrade += subject.credit * targetGrade;
        }
      });

      const gpa = totalWeightedGrade / totalCredits;
      document.getElementById("gpaResult").innerHTML =
        isNaN(gpa)
          ? ""
          : `üéì ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ: <strong>${gpa.toFixed(2)}</strong> (‡∏´‡∏≤‡∏Å‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢)`;
    }

    function addSubject() {
      const name = document.getElementById("newSubjectName").value.trim();
      const credit = parseFloat(document.getElementById("newSubjectCredit").value);

      if (name && !isNaN(credit) && credit > 0) {
        subjects.push({ name, credit });
        renderTable();
        document.getElementById("newSubjectName").value = "";
        document.getElementById("newSubjectCredit").value = "";
      } else {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
      }
    }

    // Initial render
    renderTable();
  </script>
</body>
</html>
